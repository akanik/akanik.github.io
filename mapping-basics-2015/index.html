<!DOCTYPE html>
<html>
<head>
<title>Mapping basics</title>


<!-- test compiled and minified CSS -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap.min.css">

<!-- Optional theme -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap-theme.min.css">

<!-- My stylesheet -->
<link rel="stylesheet" href="css/mapping.css">

<!-- Minified jquery -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script> 

<!-- Latest compiled and minified JavaScript -->
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>


</head>

<body>
	<div class="jumbotron">
		<div class="container">
			<h1>Mapping basics</h1>
			<p class="lead">Maps are a great way to display geographic data.</p>
			<div class="pull-left btn btn-default"><a href="data/abandoned-pa-mines-data.zip"><i class="glyphicon glyphicon-save-file"></i>Download the data</a></div>
		</div>
	</div>
	<div class="container">
		<div id="features" class="row">
			<div class="col-lg-12 col-md-12 col-sm-12">
				<h2>Adding features</h2>
				<p><img src="http://docs.qgis.org/2.2/en/_images/mActionAddOgrLayer.png" /> Vector layer</p>
				<p><img src="http://docs.qgis.org/2.2/en/_images/mActionAddRasterLayer.png" /> Raster layer</p>
				<p><img src="http://docs.qgis.org/2.2/en/_images/mActionAddDelimitedTextLayer.png" /> Delimited text layer</p>
			</div>
		</div>
		
		<div id="files" class="row">
			<div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
				<h2>What is a .qgs file?</h2>
				<p>When you save a map file, it will save as a .qgs. This file is a configuration file. It basically just references the files that you load into QGIS. IT DOES NOT HOLD ANY OF YOUR DATA. This means if you move the shapefiles you load into your map after you save it, your map will break.</p>
				<p>So dedicate a folder to each map you work on. Put your shapefiles and your map file in there and don't move them around.</p>
				<h4>This might seem like a weird, crappy way to organize things. But it's not. And here's why.</h4>
				<p>QGIS isn't perfect. Sometimes it exhibits behavior that neither you nor the message forums can explain. So your only recourse is to shut 'er down and reopen the program.</p>
				<p>And sometimes, that doesn't work either. So you need to scrap your map file.</p>
				<p>Now, if all of your work depended on that one .qgs file, that would suck hardcore. But since your shapefiles and data are separate files, and since you've taken <a href="#process-notes">crazy good process notes</a>, you're totally fine.</p>
			</div>
		</div>
		
		
		<div id="shapefiles" class="row">
			<div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
				<h2>What is a shapefile?</h2>
				<p>A shapefile is the most common vector feature type. It is comprised of a series of other files including:</p>
				<ul>
					<li>.shp - the feature geometry</li>
					<li>.shx - positioning index of the feature geometry</li>
					<li>.dbf - the data attributes for the features. This can be opened with editors like excel.</li>
					<li>.prj - projection file. This can also be opened and analyzed. Especially if you're having projection issues.</li>
				</ul>
			</div>
		</div>
		
		<div id="process-notes" class="row">
			<div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
				<h2>Naming your files and taking mad notes</h2>
				<p>There are going to be projects you work on that will require you to slice and dice a shapefile in many different ways. You need to be careful what you name each file so you aren't analyzing old shapefiles.</p>
				<p>I would strongly recommend taking detailed notes about how you change shapefiles so you can return to the notes in case you lose track of which file is which, or if something goes wrong and you need to diagnose a problem.</p>
				<figure>
					<img src="img/qgis-file-organization.png" alt="Bad file organization" />
					<figcaption>Here's an example of bad file naming. Notice the folders labelled "_old". What does that mean. I made that folder and I don't know what it means. Sigh.</figcaption>
				</figure>
			</div>
		</div>
		
		<div id="projections" class="row">
			<div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
				<h2>What is a projection?</h2>
				<p>So the earth is round, right? Turns out it's not the easiest thing to make something round and three-dimensional look flat. But to hell if we don't try.</p>
				<p>That's basically what projections are, flat representations of our round world. Lots of people have taken a stab at making the best projection, but not all projections are created equal.</p>
				<p>Depending on the scope and span of your data, you may want to stick to a more local, granular projection. But if you're trying to show the whole world things are going to get a little wonky at some point.</p>
				<p><a href="http://resources.esri.com/help/9.3/arcgisengine/dotnet/89b720a5-7339-44b0-8b58-0f5bf2843393.htm">More on projections >></a></p>
				
				<h4>Mapping projections from the 1936 Oxford Advanced Atlas compiled by John Bartholomew, cartographer to His Majesty the King</h4>
				<figure>
					<img class="img-responsive" src="img/projections-overview.JPG" alt="map projection overview">
				</figure>
				<figure class="col-lg-4 col-md-4 col-sm-12">
					<img class="img-responsive" src="img/projections-mercator.JPG" alt="mercator map projection, old">
				</figure>
				<figure class="col-lg-4 col-md-4 col-sm-12">
					<img class="img-responsive" src="img/projections-gores.JPG" alt="map projection gores">
				</figure>
				<figure class="col-lg-4 col-md-4 col-sm-12">
					<img class="img-responsive" src="img/projections-conic.JPG" alt="conic map projection">
				</figure>
			</div>
		</div>
		
		<div id="resources" class="row">
			<div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
				<h2>Resources</h2>
				<p><a href="https://docs.google.com/spreadsheets/d/1cU6UOa9bkXQezoNmX0rsylywlwlhdGatKiYuReH_eMA/edit?usp=sharing">Resources for finding (geographic) data</a></p>
				<p><a href="http://www.qgis.org/en/docs/index.html">QGIS documentation page</a></p>
				<p><a href="http://gis.stackexchange.com/">GIS StackExchange</a></p>
				<p><a href="https://www.ire.org/resource-center/listservs/subscribe-nicar-l/">NICAR-L</a></p>
			</div>
		</div>
		
		
		<div id="demo" class="row">
			<div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
				<h2>Demo</h2>
				<p>In this demo, we're going to be creating a map that overlays Pennsylvania hospitals and nursing homes with abandoned mine data.</p>
				<p>This is a blank map.</p>
				<img class="img-responsive" src="img/mapping-screenshots/adding-data-1.png" alt="blank QGIS worksheet" />
				
				
				<h3>The working directory</h3>
				<ul>
					<li><a href="data/abandoned-pa-mines-data.zip">Download the data</a></li>
					<li>Choose your working directory, and stick with it</li>
				</ul>
				<img class="img-responsive" src="img/mapping-screenshots/adding-data-4.png" alt="working directory screenshot" />
				<p>A working directory is a place on your computer where you house all of your map shapefiles. Once a shapefile is added to the working directory, it should not be moved around because that can break the file path and therefore your map.</p>
				<p>In the example above, <code>abandoned-pa-mines-data</code> is the working directory.</p>
				
				<h4>This is what you'll see if you move layers and map files around</h4>
				<img src="img/mapping-screenshots/lost-layer.png" alt="lost file screenshot" />
				
				<h3>Adding data</h3>
				<p>We're going to be focusing on VECTOR LAYERS and DELIMITED TEXT LAYERS. These are the layers you will use most often.</p>
				<h4>Adding vectors</h4>
				<ul>
					<li>Click the <img src="http://docs.qgis.org/2.2/en/_images/mActionAddOgrLayer.png" /> vector layer button</li>
					<li>Navigate to your working directory</li>
					<li>Add <code>tl_2014_42_county</code> --> <code>tl_2014_42_county.shp</code></li>
					<li>Add <code>aml_inve</code> --> <code>aml_inve.shp</code></li>
					<li>Add <code>pa-nursing-homes-20150220</code> --> <code>pa-nursing-homes-20150220-shp</code> --> <code>pa-nursing-homes-20150220.shp</code></li>
				</ul>
				<h4>Adding delimited text layers</h4>
				<ul>
					<li>Click the <img src="http://docs.qgis.org/2.2/en/_images/mActionAddDelimitedTextLayer.png" />delimited text layer button</li>
					<li>Navigate to your working directory</li>
					<li>Add the <code>pa-hospitals-20150220</code> folder --> <code>pa-hospitals-20150220-source.csv</code></li>
				</ul>
				<p><strong>Write this down:</strong></p>
				<p class="lead">Latitude = Y </p>
				<p class="lead">Longitude = X</p>
				<img src="img/mapping-screenshots/csv-upload.png" alt="csv upload screenshot" />					
				
				
				<h3>The difference between map projection and layer projection</h3>
				
				<h4>On-the-fly projecting</h4>
				<p>NOTE: On-the-fly projecting does NOT change your shapefile's projection.</p>
				<img class="img-responsive" src="img/mapping-screenshots/projections-1.png" alt="projecting layers screenshot" />
				<img class="img-responsive" src="img/mapping-screenshots/projections-2.png" alt="projecting layers screenshot" />
				<img class="img-responsive" src="img/mapping-screenshots/projections-3.png" alt="projecting layers screenshot" />
				<h4>Changing a shapefile's projection</h4>
				<ul>
					<li>Right-click the layer you'd like to change</li>
					<li>Select "Save as"</li>
				</ul>
				<img class="img-responsive" src="img/mapping-screenshots/projections-layer-1.png" alt="projecting layers screenshot" />
				<img class="img-responsive" src="img/mapping-screenshots/projections-layer-2.png" alt="projecting layers screenshot" />
				
				
				<h3>Styling</h3>
				<ul>
					<li>Right-click or double-click the layer</li>
					<li>Select the Style tab</li>
					<li>Style accordingly</li>
				</ul>
				<img class="img-responsive" src="img/mapping-screenshots/styling-1.png" alt="styling layers screenshot" />
				
				<h3>Selecting by location</h3>
				<p>Now we want to take a look at only those hospitals or nursing homes that sit on top of abandoned mines.</p>
				<ul>
					<li>Navigate to the Vector menu > Research tools > Select by location</li>
				</ul>
				<img class="img-responsive" src="img/mapping-screenshots/select-by-location-1.png" alt="selecting features by location screenshot" />
				<ul>
					<li><strong>Select features in</strong> = the shapefile you want to refine</li>
					<li><strong>That intersect features in</strong> = the shapefile that will determine which features are selected, the intersect layer</li>
				</ul>
				<img class="img-responsive" src="img/mapping-screenshots/select-by-location-2.png" alt="selecting features by location screenshot" />
				<ul>
					<li>Right-click layer and select "Save as"</li>
					<li>Follow normal saving procedures, but make sure to check the "Save only selected features" box</li>
					<li>You probably want to add this file to the map after it's created, so check "Add saved file to map" also</li>
				</ul>
				<img class="img-responsive" src="img/mapping-screenshots/select-by-location-3.png" alt="selecting features by location screenshot" />
				
				
				<h3>Analyzing the attribute table</h3>
				<p>There are a couple of ways to analyze a selection once you've created and saved it.</p>
				<ol>
					<li>Right-click the layer and choose "Open Attribute Table"</li>
					<li>Navigate to where the layer is stored in your working directory and open the .dbf file with an editor like excel or libreoffice</li>
				</ol>
				<img class="img-responsive" src="img/mapping-screenshots/attribute-table.png" alt="attribute table screenshot" />
				
				
				
				
			</div>
		</div>
		
		
		
		
		
	</div>
</body>

</html>
